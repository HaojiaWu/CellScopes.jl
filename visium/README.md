# Analysis and visualization of Visium data with CellScopes.jl
Below are some simple codes to walk you through how to use ```CellScopes.jl``` to analyze the Visium data generated by the 10x spaceranger tool.

## 1. Read the visium data

We provide a function that can directly read the visium data and create a visium spatial object for downstream analysis. The spots and genes can be filtered by setting the parameters ```min_gene``` and ```min_cell``` in this step.

```julia
import CellScopes as cs
sham = cs.read_visium("/home/data/Jia/shamA_visium/MGI0805_A3_147_msham/outs/")
```
This should create an data type called ```VisiumObject```.
```
VisiumObject in CellScopes.jl
Genes x Cells = 17592 x 1815
Available data:
- rawCount
- metaData
- spmetaData
- imageData
All fields:
- rawCount
- normCount
- scaleCount
- metaData
- spmetaData
- varGene
- dimReduction
- clustData
- imageData
```

### 2. Normalization, dimension reduction and cell clustering
We then perform data normalization, dimension reduction and cell clustering on the Visium Object.
```julia
sham = cs.normalize_object(sham; scale_factor = 10000)
sham = cs.scale_object(sham)
sham = cs.find_variable_genes(sham; nFeatures = 1000)
sham = cs.run_pca(sham;  method=:svd, pratio = 1, maxoutdim = 10)
sham = cs.run_umap(sham; min_dist=0.2, n_neighbors=20)
sham = cs.run_clustering(sham; res=0.01, n_neighbors=20)
```
### 3. Visiualization
We provide a set of functions to help visualize the cell and gene expression on the dimension reduction space and the spatial space.

#### 3.1 Cell type visiualization
##### a. Visualize the cell clustering on UMAP.
```julia
cs.dim_plot(sham; dim_type ="umap", marker_size=4)
```
<img src="https://github.com/HaojiaWu/CellScopes.jl/blob/main/data/umap_vsm.png" width="600"> 
##### b. Visualize the cell type distribution on tissue
```julia
```
<img src="https://github.com/HaojiaWu/CellScopes.jl/blob/main/data/sp_vsm.png" width="600"> 

##### c. Highlight the cell type of interest

#### 3.2 Gene expression visiualization



